{"version":3,"file":"Component-dbg.js","names":["createDeviceModel","___model_models","getConfidentialInfo","___env","Component","BaseComponent","extend","metadata","manifest","init","_init","_loadScripts","BaseComponent.prototype.init.call","oRouter","getRouter","initialize","_logRouteName","setModel","scripts","forEach","script","tag","document","createElement","src","head","appendChild","_this","authInfo","userLock","getModel","oDataModel","attachRouteMatched","ev","oRouteName","getParameter","userEmail","sap","ushell","Container","getService","getEmail","production","mockEmail","Promise","resolve","navTo","userId","includes","split","toString","newUser","JSON","stringify","parseInt","setProperty","userAuthentication","reports","create","settings","analytics","navListModel","navListData","push","authData","getProperty","e","reject"],"sources":["Component.ts"],"sourcesContent":["import BaseComponent from \"sap/ui/core/UIComponent\";\nimport { createDeviceModel } from \"./model/models\";\nimport { getConfidentialInfo } from \"./env\";\nimport JSONModel from \"sap/ui/model/json/JSONModel\";\nimport { GET } from \"./utlity/apiCall\";\nimport ODataModel from \"sap/ui/model/odata/v4/ODataModel\";\nimport Filter from \"sap/ui/model/Filter\";\nimport FilterOperator from \"sap/ui/model/FilterOperator\";\n\n/**\n * @namespace wisys.frontend\n */\nexport default class Component extends BaseComponent {\n  public static metadata = {\n    manifest: \"json\",\n  };\n\n  /**\n   * The component is initialized by UI5 automatically during the startup of the app and calls the init method once.\n   * @public\n   * @override\n   */\n  private oDataModel: ODataModel;\n  public init(): void {\n    // Load the XLSX scripts dynamically\n    this._loadScripts();\n    // call the base component's init function\n    super.init();\n\n    const oRouter = this.getRouter();\n    oRouter.initialize();\n\n    // Log route name\n    this._logRouteName(oRouter);\n\n    // set the device model\n    this.setModel(createDeviceModel(), \"device\");\n  }\n  private _loadScripts(): any {\n    const scripts = [\n      \"https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.15/jspdf.plugin.autotable.min.js\",\n      \"https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js\",\n      \"https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.8.0/jszip.js\",\n      \"https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.8.0/xlsx.js\",\n    ];\n    scripts.forEach((script) => {\n      const tag = document.createElement(\"script\");\n      tag.src = script;\n      document.head.appendChild(tag);\n    });\n  }\n\n  private _logRouteName(oRouter: any): void {\n    const authInfo = getConfidentialInfo()\n    const userLock = this.getModel(\"userModel\") as JSONModel;\n    this.oDataModel = this?.getModel() as ODataModel\n\n    oRouter.attachRouteMatched(async (ev: any) => {\n      const oRouteName = ev.getParameter(\"name\");\n      let userEmail = ((sap.ushell as any).Container?.getService(\"UserInfo\") as any)?.getEmail();\n      if (authInfo.production === false) { userEmail = authInfo.mockEmail }\n      if (!userEmail) {\n        return oRouter.navTo(\"RouteError\");\n      }\n      const userId = userEmail?.includes('@') ? userEmail.split('@')[0].toString() : userEmail.toString()\n      let newUser = JSON.stringify(parseInt(userId))\n      // console.log(\"component.ts userId\", newUser)\n      userLock.setProperty(\"/userId\", newUser)\n      console.log(\"Intial userID\", newUser)\n      // CPI ACL CONFIG\n      // const payload = {\n      // }\n\n      // const POST = async (\n      //   model: any,  // ODataV4Model\n      //   entitySet: string,\n      //   newData: any\n      // ): Promise<any> => {\n      //   return new Promise((resolve, reject) => {\n      //     // Bind the entity set to the ListBinding to perform the POST\n      //     const listBinding = model.bindList(entitySet);\n\n      //     // Call the create method and pass success/error callbacks\n      //     const contextBinding = listBinding.create(newData, false, {\n      //       success: (createdEntity: any) => {\n      //         console.log(\"Record created successfully!\", createdEntity);\n      //         resolve(createdEntity);  // Resolve with the created record data\n      //       },\n      //       error: (error: any) => {\n      //         console.log(\"Error creating record:\", error);\n      //         reject(error);  // Reject in case of an error\n      //       }\n      //     });\n\n      //     if (!contextBinding) {\n      //       reject(new Error(\"Failed to create context binding\"));\n      //     }\n      //   });\n      // };\n\n\n      // try {\n      //   let userAccess2 = await POST(this.oDataModel, '/cpiAcl', payload)\n      //   console.log(userAccess2)\n      // } catch (error) {\n      //   console.error(error)\n      // }\n\n      // const userAccess2 = await GET(this.oDataModel, `/cpiAcl`) as [];\n\n      // console.log(\"userAccess2\", userAccess2);\n      // const userAccessEntries = userAccess2[0].feed.entry; // Access the 'entry' array inside the 'feed'\n      // console.log(\"userAccessEntries --------------------------------------\", userAccessEntries)\n\n      // const userIds = userAccessEntries.find((entry: any) => entry.content.properties.userId === userId);\n      // const userData = userIds.content.properties\n      // console.log(\"userData\", userData);\n      // END CPI ACL CONFIG\n\n\n      // const userAccess = await GET(this.oDataModel, `/Access_UserSet`) as []\n      // const userData = userAccess.find((item: any) => item.appId === authInfo.AppId && item.userId === userId) as any\n      // const userData = userAccess.find((item: any) => item.userId === userId) as any\n      // console.log(userData)\n\n\n      // if (!userData || !userData?.status) {\n      //   return oRouter.navTo(\"RouteError\");\n      // }\n      const userAuthentication = {\n        reports: true,\n        create: true,\n        settings: true,\n        analytics: true\n      }\n      // console.log(\"userAuthentication\", userAuthentication)\n      userLock.setProperty(\"/auth\", userAuthentication)\n\n      const navListModel = this?.getModel('navList') as JSONModel\n      const navListData = [\n        {\n          \"title\": \"Home\",\n          \"icon\": \"sap-icon://home\",\n          \"key\": \"RouteHome\"\n        },\n        {\n          \"title\": \"Time Sheet\",\n          \"icon\": \"sap-icon://end-user-experience-monitoring\",\n          \"key\": \"RouteAttendance\"\n        },\n        {\n          \"title\": \"My Task\",\n          \"icon\": \"sap-icon://activity-assigned-to-goal\",\n          \"key\": \"RouteMyTask\"\n        },\n        {\n          \"title\": \"Employees\",\n          \"icon\": \"sap-icon://employee\",\n          \"key\": \"RouteDashboard\"\n        },\n        {\n          \"title\": \"Request Status\",\n          \"icon\": \"sap-icon://step\",\n          \"key\": \"RouteRequestStatus\"\n        }\n      ]\n      if (userAuthentication?.create) {\n        navListData.push({\n          \"title\": \"Add Employee\",\n          \"icon\": \"sap-icon://add\",\n          \"key\": \"RouteEmployee\"\n        }, {\n          \"title\": \"Bulk Upload\",\n          \"icon\": \"sap-icon://upload-to-cloud\",\n          \"key\": \"RouteBulkUpload\"\n        });\n      }\n      if (userAuthentication?.settings) {\n        navListData.push({\n          \"title\": \"Settings\",\n          \"icon\": \"sap-icon://action-settings\",\n          \"key\": \"RouteSetting\",\n          \"items\": [\n            {\n              \"title\": \"Workflow Approvers\",\n              \"icon\": \"sap-icon://people-connected\",\n              \"key\": \"RouteApprover\"\n            },\n            {\n              \"title\": \"Master Data\",\n              \"icon\": \"sap-icon://database\",\n              \"key\": \"RouteMasterData\"\n            },\n            {\n              \"title\": \"Reassign request\",\n              \"icon\": \"sap-icon://citizen-connect\",\n              \"key\": \"RouteReassign\"\n            }\n          ]\n        });\n      }\n      navListModel?.setProperty(\"/navigation\", navListData)\n      const authData = userLock.getProperty(\"/auth\");\n      console.log(\"authData\", authData)\n      console.log(\"Route Name\", oRouteName)\n\n      if (oRouteName === \"RouteSettings\" && !authData?.settings || oRouteName === \"RouteApprover\" && !authData?.settings || oRouteName === \"RouteMasterData\" && !authData?.settings || oRouteName === \"RouteReassign\" && !authData?.settings) {\n        return oRouter.navTo(\"RouteError\");\n      }\n      if (oRouteName === \"RouteBulkUpload\" && !authData?.create) {\n        return oRouter.navTo(\"RouteError\");\n      }\n    })\n  }\n}\n"],"mappings":"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","ignoreList":[]}