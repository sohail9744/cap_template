{"version":3,"file":"App.controller.js","names":["_catch","body","recover","result","e","then","getConfidentialInfo","___env","App","Controller","extend","onInit","_onInit","this","router","UIComponent","getRouterFor","onMenuButtonPress","onBeforeRendering","_onBeforeRendering","userAuthentication","_userAuthentication","_this","authInfo","userEmail","sap","ushell","Container","getService","getEmail","production","mockEmail","userId","includes","split","toString","validatingUser","Promise","resolve","reject","_validatingUser","_this2","oModel","getView","getModel","Error","oActionODataContextBinding","bindContext","setParameter","_temp","execute","oActionContext","getBoundContext","data","getObject","value","insertUserData","getOwnerComponent","setData","username","userLocation","city","userName","displayName","position","title","nationality","grade","payGrade","department","division","section","location","managerName","manager","managerId","managerEmail","updateBindings","setBusy","error","_onMenuButtonPress","toolPage","byId","setSideExpanded","getSideExpanded","onItemSelect","_onItemSelect","ev","item","getParameter","getKey","navTo"],"sources":["App.controller.ts"],"sourcesContent":["import Controller from \"sap/ui/core/mvc/Controller\";\nimport ToolPage from \"sap/tnt/ToolPage\";\nimport Router from \"sap/ui/core/routing/Router\";\nimport UIComponent from \"sap/ui/core/UIComponent\";\nimport JSONModel from \"sap/ui/model/json/JSONModel\";\nimport { getConfidentialInfo } from \"../env\";\nimport MessageBox from \"sap/m/MessageBox\";\nimport { FETCH_POST, GET, POST } from \"../utlity/apiCall\";\nimport ODataModel from \"sap/ui/model/odata/v4/ODataModel\";\nimport FilterOperator from \"sap/ui/model/FilterOperator\";\n/**\n * @namespace wisys.frontend.controller\n */\nexport default class App extends Controller {\n  public router: any;\n  private oDataModel: any\n  /*eslint-disable @typescript-eslint/no-empty-function*/\n  onInit(): void {\n    this.router = UIComponent.getRouterFor(this);\n    this.onMenuButtonPress();\n  }\n\n  public onBeforeRendering(): void {\n    this.userAuthentication()\n  }\n\n  async userAuthentication() {\n\n    const authInfo = getConfidentialInfo();\n    let userEmail = ((sap.ushell as any).Container?.getService(\"UserInfo\") as any)?.getEmail();\n\n    if (authInfo.production === false) { userEmail = authInfo.mockEmail }\n    console.log(\"App.controller.js User Email\", userEmail)\n\n    if (userEmail) {\n      let userId = userEmail?.includes('@') ? userEmail.split('@')[0].toString() : userEmail.toString()\n      this.validatingUser(userId)\n    }\n  }\n\n  protected async validatingUser(userId: any) {\n    // Get the OData model from the view\n    const oModel = this.getView()?.getModel() as ODataModel;\n\n    // Ensure the model is available\n    if (!oModel) {\n      throw new Error(\"OData model is not available.\");\n    }\n\n    // Bind the action context\n    const oActionODataContextBinding = oModel.bindContext(\"/sfUser1(...)\");\n\n    // Set the action parameter\n    oActionODataContextBinding.setParameter(\"userId\", userId);\n\n    // Execute the action\n    try {\n      await oActionODataContextBinding.execute();\n      const oActionContext = oActionODataContextBinding.getBoundContext();\n      // Log or process the result\n      if (oActionContext) {\n        let data = oActionContext.getObject().value[0]\n        console.log({\n          \"userId\": data?.userId,\n          \"userEmail\": data?.username,\n          \"userLocation\": data?.city,\n          \"userName\": data?.displayName,\n          \"position\": data?.title,\n          \"nationality\": data?.nationality,\n          \"grade\": data?.payGrade,\n          \"department\": data?.division,\n          \"section\": data?.department,\n          \"location\": data?.city,\n          \"managerName\": data?.manager?.displayName,\n          \"managerId\": data?.manager?.userId,\n          \"managerEmail\": data?.manager?.username,\n        })\n\n        let insertUserData = this.getOwnerComponent()?.getModel('userModel') as JSONModel\n        insertUserData?.setData({\n          \"userId\": data?.userId,\n          \"userEmail\": data?.username,\n          \"userLocation\": data?.city,\n          \"userName\": data?.displayName,\n          \"position\": data?.title,\n          \"nationality\": data?.nationality,\n          \"grade\": data?.payGrade,\n          \"department\": data?.division,\n          \"section\": data?.department,\n          \"location\": data?.city,\n          \"managerName\": data?.manager?.displayName,\n          \"managerId\": data?.manager?.userId,\n          \"managerEmail\": data?.manager?.username,\n        })\n        insertUserData.updateBindings(true)\n        this.getView()?.setBusy(false)\n      } else {\n        console.warn(\"Action executed successfully, but no context returned.\");\n      }\n    } catch (error) {\n      debugger\n      console.error(\"Error executing the action:\", error);\n    }\n  }\n\n  protected onMenuButtonPress(): void {\n    let toolPage = this.byId(\"toolPage\") as ToolPage;\n    toolPage?.setSideExpanded(!toolPage?.getSideExpanded());\n  }\n  protected onItemSelect(ev: any): void {\n    let item = ev.getParameter(\"item\").getKey();\n    this.router.navTo(item);\n  }\n}\n"],"mappings":"0HAkjBO,SAAAA,EAAgBC,EAAMC,GAC5B,IACC,IAAIC,EAASF,GACd,CAAE,MAAMG,GACP,OAAOF,EAAQE,EAChB,CACA,GAAID,GAAUA,EAAOE,KAAM,CAC1B,OAAOF,EAAOE,UAAU,EAAGH,EAC5B,CACA,OAAOC,CACR,CAAC,MAvjBQG,EAAmBC,EAAA,uBAK5B,MAGqBC,EAAYC,EAAUC,OAAA,iCAIzCC,OAAM,SAAAC,IACJC,KAAKC,OAASC,EAAYC,aAAaH,MACvCA,KAAKI,mBACP,EAEOC,kBAAiB,SAAAC,IACtBN,KAAKO,oBACP,EAEMA,mBAAkB,SAAAC,IAAA,IAAG,MAAAC,EAUvBT,KARF,MAAMU,EAAWjB,IACjB,IAAIkB,EAAcC,IAAIC,OAAeC,WAAWC,WAAW,aAAqBC,WAEhF,GAAIN,EAASO,aAAe,MAAO,CAAEN,EAAYD,EAASQ,SAAU,CAGpE,GAAIP,EAAW,CACb,IAAIQ,EAASR,GAAWS,SAAS,KAAOT,EAAUU,MAAM,KAAK,GAAGC,WAAaX,EAAUW,WACvFb,EAAKc,eAAeJ,EACtB,CAAC,OAAAK,QAAAC,SACH,CAAC,MAAAlC,GAAA,OAAAiC,QAAAE,OAAAnC,EAAA,GAEegC,eAAc,SAAAI,EAACR,GAAW,IAAE,MAAAS,EAE3B5B,KAAf,MAAM6B,EAASD,EAAKE,WAAWC,WAG/B,IAAKF,EAAQ,CACX,MAAM,IAAIG,MAAM,gCAClB,CAGA,MAAMC,EAA6BJ,EAAOK,YAAY,iBAGtDD,EAA2BE,aAAa,SAAUhB,GAElD,MAAAiB,EAAAjD,EAAA,WACI,OAAAqC,QAAAC,QACIQ,EAA2BI,WAAS7C,KAAA,WAC1C,MAAM8C,EAAiBL,EAA2BM,kBAClD,GACID,EAAc,CAChB,IAAIE,EAAOF,EAAeG,YAAYC,MAAM,GAiB5C,IAAIC,EAAiBf,EAAKgB,qBAAqBb,SAAS,aACxDY,GAAgBE,QAAQ,CACtB1B,OAAUqB,GAAMrB,OAChBR,UAAa6B,GAAMM,SACnBC,aAAgBP,GAAMQ,KACtBC,SAAYT,GAAMU,YAClBC,SAAYX,GAAMY,MAClBC,YAAeb,GAAMa,YACrBC,MAASd,GAAMe,SACfC,WAAchB,GAAMiB,SACpBC,QAAWlB,GAAMgB,WACjBG,SAAYnB,GAAMQ,KAClBY,YAAepB,GAAMqB,SAASX,YAC9BY,UAAatB,GAAMqB,SAAS1C,OAC5B4C,aAAgBvB,GAAMqB,SAASf,WAEjCH,EAAeqB,eAAe,MAC9BpC,EAAKE,WAAWmC,QAAQ,MAAM,SAIlC,EAAC,SAAQC,GACP,QAEF,GAAC,OAAA1C,QAAAC,QAAAW,KAAA5C,KAAA4C,EAAA5C,KAAA,qBACH,CAAC,MAAAD,GAAA,OAAAiC,QAAAE,OAAAnC,EAAA,GAESa,kBAAiB,SAAA+D,IACzB,IAAIC,EAAWpE,KAAKqE,KAAK,YACzBD,GAAUE,iBAAiBF,GAAUG,kBACvC,EACUC,aAAY,SAAAC,EAACC,GACrB,IAAIC,EAAOD,EAAGE,aAAa,QAAQC,SACnC7E,KAAKC,OAAO6E,MAAMH,EACpB,IAAC,OAnGkBhF,CAAG","ignoreList":[]}