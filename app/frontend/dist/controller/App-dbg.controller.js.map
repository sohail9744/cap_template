{"version":3,"file":"App-dbg.controller.js","names":["_catch","body","recover","result","e","then","getConfidentialInfo","___env","App","Controller","extend","onInit","_onInit","router","UIComponent","getRouterFor","onMenuButtonPress","onBeforeRendering","_onBeforeRendering","userAuthentication","_userAuthentication","_this","authInfo","userEmail","sap","ushell","Container","getService","getEmail","production","mockEmail","userId","includes","split","toString","validatingUser","Promise","resolve","reject","_validatingUser","_this2","oModel","getView","getModel","Error","oActionODataContextBinding","bindContext","setParameter","_temp","execute","oActionContext","getBoundContext","data","getObject","value","insertUserData","getOwnerComponent","setData","username","city","displayName","title","nationality","payGrade","division","department","manager","updateBindings","setBusy","error","_onMenuButtonPress","toolPage","byId","setSideExpanded","getSideExpanded","onItemSelect","_onItemSelect","ev","item","getParameter","getKey","navTo"],"sources":["App.controller.ts"],"sourcesContent":["import Controller from \"sap/ui/core/mvc/Controller\";\nimport ToolPage from \"sap/tnt/ToolPage\";\nimport Router from \"sap/ui/core/routing/Router\";\nimport UIComponent from \"sap/ui/core/UIComponent\";\nimport JSONModel from \"sap/ui/model/json/JSONModel\";\nimport { getConfidentialInfo } from \"../env\";\nimport MessageBox from \"sap/m/MessageBox\";\nimport { FETCH_POST, GET, POST } from \"../utlity/apiCall\";\nimport ODataModel from \"sap/ui/model/odata/v4/ODataModel\";\nimport FilterOperator from \"sap/ui/model/FilterOperator\";\n/**\n * @namespace wisys.frontend.controller\n */\nexport default class App extends Controller {\n  public router: any;\n  private oDataModel: any\n  /*eslint-disable @typescript-eslint/no-empty-function*/\n  onInit(): void {\n    this.router = UIComponent.getRouterFor(this);\n    this.onMenuButtonPress();\n  }\n\n  public onBeforeRendering(): void {\n    this.userAuthentication()\n  }\n\n  async userAuthentication() {\n\n    const authInfo = getConfidentialInfo();\n    let userEmail = ((sap.ushell as any).Container?.getService(\"UserInfo\") as any)?.getEmail();\n\n    if (authInfo.production === false) { userEmail = authInfo.mockEmail }\n    console.log(\"App.controller.js User Email\", userEmail)\n\n    if (userEmail) {\n      let userId = userEmail?.includes('@') ? userEmail.split('@')[0].toString() : userEmail.toString()\n      this.validatingUser(userId)\n    }\n  }\n\n  protected async validatingUser(userId: any) {\n    // Get the OData model from the view\n    const oModel = this.getView()?.getModel() as ODataModel;\n\n    // Ensure the model is available\n    if (!oModel) {\n      throw new Error(\"OData model is not available.\");\n    }\n\n    // Bind the action context\n    const oActionODataContextBinding = oModel.bindContext(\"/sfUser1(...)\");\n\n    // Set the action parameter\n    oActionODataContextBinding.setParameter(\"userId\", userId);\n\n    // Execute the action\n    try {\n      await oActionODataContextBinding.execute();\n      const oActionContext = oActionODataContextBinding.getBoundContext();\n      // Log or process the result\n      if (oActionContext) {\n        let data = oActionContext.getObject().value[0]\n        console.log({\n          \"userId\": data?.userId,\n          \"userEmail\": data?.username,\n          \"userLocation\": data?.city,\n          \"userName\": data?.displayName,\n          \"position\": data?.title,\n          \"nationality\": data?.nationality,\n          \"grade\": data?.payGrade,\n          \"department\": data?.division,\n          \"section\": data?.department,\n          \"location\": data?.city,\n          \"managerName\": data?.manager?.displayName,\n          \"managerId\": data?.manager?.userId,\n          \"managerEmail\": data?.manager?.username,\n        })\n\n        let insertUserData = this.getOwnerComponent()?.getModel('userModel') as JSONModel\n        insertUserData?.setData({\n          \"userId\": data?.userId,\n          \"userEmail\": data?.username,\n          \"userLocation\": data?.city,\n          \"userName\": data?.displayName,\n          \"position\": data?.title,\n          \"nationality\": data?.nationality,\n          \"grade\": data?.payGrade,\n          \"department\": data?.division,\n          \"section\": data?.department,\n          \"location\": data?.city,\n          \"managerName\": data?.manager?.displayName,\n          \"managerId\": data?.manager?.userId,\n          \"managerEmail\": data?.manager?.username,\n        })\n        insertUserData.updateBindings(true)\n        this.getView()?.setBusy(false)\n      } else {\n        console.warn(\"Action executed successfully, but no context returned.\");\n      }\n    } catch (error) {\n      debugger\n      console.error(\"Error executing the action:\", error);\n    }\n  }\n\n  protected onMenuButtonPress(): void {\n    let toolPage = this.byId(\"toolPage\") as ToolPage;\n    toolPage?.setSideExpanded(!toolPage?.getSideExpanded());\n  }\n  protected onItemSelect(ev: any): void {\n    let item = ev.getParameter(\"item\").getKey();\n    this.router.navTo(item);\n  }\n}\n"],"mappings":"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","ignoreList":[]}